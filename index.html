<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue.js Lessons</title>
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <link rel="stylesheet" href="Styles/style.css">
    <script src="https://kit.fontawesome.com/0ecb2c1182.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
        integrity="sha384-BVYiiSIFeK1dGJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
</head>

<body>
    <div id="app">
        <header>
            <h1 v-text="sitename"></h1>
            <!-- Created cart button that activates only if there's something in the cart -->
            <button v-html="cartCount + ' ' + cartButton" v-on:click="showCheckout" v-if="cartCount && showProduct"></button>
            <!-- This was made in case the cart was emptied and otherwise you could not go back to product page -->
            <button v-html="cartCount + ' ' + cartButton" v-on:click="showCheckout" v-else-if="!showProduct"></button>
            <button v-html="cartCount + ' ' + cartButton" disabled v-else></button>
        </header>
        <!-- Shows the product page if this is true -->
        <div v-if="showProduct">
            <h2 class="pageHeader">Product List</h2>
            <!-- Creates search field 
                Since Vue.js updates the fields every time there is a change the search includes search while typing -->
            <div class="searchBox">
                <p>
                    Search:
                    <input type="text" class="searchInput" v-model="searchTerm" />
                </p>
            </div>
            <!-- Creates radio buttons for sorting products using Vue.js two way binding -->
            <div class="searchAndSort">
                <p><input type="radio" id="priceLowHigh" value="priceLowHigh" v-model="sortStyle">
                    <label for="priceLowHigh">Price: Low to High</label>
                </p>
                <p>
                    <input type="radio" id="priceHighLow" value="priceHighLow" v-model="sortStyle">
                    <label for="priceHighLow">Price : High to Low</label>
                </p>
                <p>
                    <input type="radio" id="aToZ" value="aToZ" v-model="sortStyle">
                    <label for="aToZ">Name: A to Z</label>
                </p>
                <p>
                    <input type="radio" id="zToA" value="zToA" v-model="sortStyle">
                    <label for="zToA">Name: Z to A</label>
                </p>

            </div>
            <!-- Displays products that match the search criteria if the search field is not empty -->
            <div v-for="product in filteredProducts" class="lesson">
                <img class="lessonImage" v-bind:src="product.image">
                <h2>Subject: {{product.name}}</h2>
                <p>Location: {{product.location}}</p>
                <p>Price: Â£{{product.price}}</p>
                <p>Spaces available: {{product.spaces}}</p>
                <button v-html="lessonButton" v-on:click="addToCart(product)" v-if="canAdd(product)"></button>
                <button v-html="lessonButton" disabled v-else></button>
            </div>
        </div>
        <!-- Shows checkout page if showProduct is false -->
        <div class="checkout" v-else>
            <h2 class="pageHeader">Shopping Cart</h2>
            <!-- Loops through the products and if they match the ID in the cart it shows it on this page as well as their frequency -->
            <div v-for="product in cartItems" class="lesson">
                <img class="lessonImage" v-bind:src="product.image">
                <h2>Subject: {{product.name}}</h2>
                <p>Location: {{product.location}}</p>
                <p>Price: Â£{{product.price}}</p>
                <p>Spaces available: {{product.spaces}}</p>
                <button @click="removeFromCart(product)">Remove</button>
            </div>
            <!-- Creates fields for the user to type their details -->
            <div class="basket">
                <p>
                    First Name:
                    <input class="inputField" v-model="order.firstName" />
                </p>
                <p>
                    Last Name:
                    <input class="inputField" v-model="order.lastName" />
                </p>
                <p>
                    Phone Number:
                    <input v-model="order.phoneNo" />
                </p>
                <!-- Button is disabled if any fields are empty or don't match the RegEx -->
                <button :disabled="!emptyFields" @click="placeOrder">Place Order</button>
            </div>

        </div>
    </div>
    <script src="Scripts/products.js"></script>
    <script src="Scripts/script.js"></script>
    <script>
        new Vue({
            el: '#app',
            data: {
                sitename: 'Vue.js Lessons',
                cart: [],
                showProduct: true,
                searchTerm: '',
                sortStyle: '',
                products: [
                    // Add your products here
                    // Example:
                    { id: 1, name: 'Math', location: 'London', price: 30, spaces: 5, image: 'math.jpg' },
                    { id: 2, name: 'English', location: 'Manchester', price: 25, spaces: 2, image: 'english.jpg' },
                    // Add more products as needed
                ],
                order: {
                    firstName: '',
                    lastName: '',
                    phoneNo: ''
                },
                cartButton: 'ðŸ›’ Cart',
                lessonButton: 'Add to Cart',
            },
            computed: {
                cartCount() {
                    return this.cart.length;
                },
                emptyFields() {
                    return this.order.firstName && this.order.lastName && this.order.phoneNo;
                },
                filteredProducts() {
                    let filtered = this.products;
                    if (this.searchTerm) {
                        filtered = filtered.filter(product =>
                            product.name.toLowerCase().includes(this.searchTerm.toLowerCase())
                        );
                    }
                    if (this.sortStyle) {
                        if (this.sortStyle === 'priceLowHigh') {
                            filtered.sort((a, b) => a.price - b.price);
                        } else if (this.sortStyle === 'priceHighLow') {
                            filtered.sort((a, b) => b.price - a.price);
                        } else if (this.sortStyle === 'aToZ') {
                            filtered.sort((a, b) => a.name.localeCompare(b.name));
                        } else if (this.sortStyle === 'zToA') {
                            filtered.sort((a, b) => b.name.localeCompare(a.name));
                        }
                    }
                    return filtered;
                },
                cartItems() {
                    return this.cart.map(cartItem => {
                        const product = this.products.find(product => product.id === cartItem.id);
                        return { ...product, quantity: cartItem.quantity };
                    });
                }
            },
            methods: {
                addToCart(product) {
                    const cartItem = this.cart.find(item => item.id === product.id);
                    if (cartItem) {
                        cartItem.quantity++;
                    } else {
                        this.cart.push({ id: product.id, quantity: 1 });
                    }
                    product.spaces--;
                },
                canAdd(product) {
                    return product.spaces > 0;
                },
                removeFromCart(product) {
                    const cartItem = this.cart.find(item => item.id === product.id);
                    if (cartItem) {
                        if (cartItem.quantity > 1) {
                            cartItem.quantity--;
                        } else {
                            this.cart = this.cart.filter(item => item.id !== product.id);
                        }
                        product.spaces++;
                    }
                },
                showCheckout() {
                    this.showProduct = !this.showProduct;
                },
                placeOrder() {
                    alert('Order placed!');
                    this.cart = [];
                    this.order.firstName = '';
                    this.order.lastName = '';
                    this.order.phoneNo = '';
                    this.showProduct = true;
                }
            }
        });
    </script>
</body>

</html>
